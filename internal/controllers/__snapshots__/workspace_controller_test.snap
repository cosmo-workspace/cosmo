['Workspace controller when creating a Workspace resource should do reconcile once and create Instance resources 1']
SnapShot = """
{
  \"metadata\": {
    \"name\": \"ws-test\",
    \"namespace\": \"cosmo-user-wsctltest\",
    \"creationTimestamp\": null,
    \"ownerReferences\": [
      {
        \"apiVersion\": \"cosmo-workspace.github.io/v1alpha1\",
        \"kind\": \"Workspace\",
        \"name\": \"ws-test\",
        \"uid\": \"\",
        \"controller\": true,
        \"blockOwnerDeletion\": true
      }
    ]
  },
  \"spec\": {
    \"template\": {
      \"name\": \"code-server-test\"
    },
    \"vars\": {
      \"{{DOMAIN}}\": \"example.com\",
      \"{{IMAGE_TAG}}\": \"latest\",
      \"{{USER_NAME}}\": \"wsctltest\",
      \"{{WORKSPACE_DEPLOYMENT_NAME}}\": \"ws-dep\",
      \"{{WORKSPACE_INGRESS_NAME}}\": \"ws-ing\",
      \"{{WORKSPACE_SERVICE_MAIN_PORT_NAME}}\": \"mainPort\",
      \"{{WORKSPACE_SERVICE_NAME}}\": \"ws-svc\",
      \"{{WORKSPACE}}\": \"ws-test\"
    },
    \"override\": {
      \"scale\": [
        {
          \"target\": {
            \"kind\": \"Deployment\",
            \"name\": \"ws-dep\",
            \"apiVersion\": \"apps/v1\"
          },
          \"replicas\": 1
        }
      ],
      \"network\": {
        \"ingress\": [
          {
            \"targetName\": \"ws-ing\"
          }
        ],
        \"service\": [
          {
            \"targetName\": \"ws-svc\"
          }
        ]
      },
      \"patchesJson6902\": [
        {
          \"target\": {
            \"kind\": \"IngressRoute\",
            \"name\": \"ws-ing\",
            \"apiVersion\": \"traefik.io/v1alpha1\"
          },
          \"patch\": \"[{\\n\\\"op\\\": \\\"replace\\\",\\n\\\"path\\\": \\\"/spec/routes\\\",\\n\\\"value\\\": []\\n}]\"
        }
      ]
    }
  },
  \"status\": {}
}
"""

['Workspace controller when creating a Workspace resource should do reconcile once and create Instance resources 2']
SnapShot = """
{
  \"metadata\": {
    \"name\": \"ws-test\",
    \"namespace\": \"cosmo-user-wsctltest\",
    \"creationTimestamp\": null,
    \"labels\": {
      \"cosmo-workspace.github.io/controller-managed\": \"1\"
    },
    \"ownerReferences\": [
      {
        \"apiVersion\": \"cosmo-workspace.github.io/v1alpha1\",
        \"kind\": \"Workspace\",
        \"name\": \"ws-test\",
        \"uid\": \"\",
        \"controller\": true,
        \"blockOwnerDeletion\": true
      }
    ]
  },
  \"spec\": {
    \"routes\": [],
    \"entryPoints\": [
      \"web\",
      \"websecure\"
    ]
  }
}
"""

['Workspace controller when updating Workspace spec should do reconcile again and update child Instance 1']
SnapShot = """
{
  \"metadata\": {
    \"name\": \"ws-test\",
    \"namespace\": \"cosmo-user-wsctltest\",
    \"creationTimestamp\": null,
    \"ownerReferences\": [
      {
        \"apiVersion\": \"cosmo-workspace.github.io/v1alpha1\",
        \"kind\": \"Workspace\",
        \"name\": \"ws-test\",
        \"uid\": \"\",
        \"controller\": true,
        \"blockOwnerDeletion\": true
      }
    ]
  },
  \"spec\": {
    \"template\": {
      \"name\": \"code-server-test\"
    },
    \"vars\": {
      \"{{DOMAIN}}\": \"example.com\",
      \"{{IMAGE_TAG}}\": \"latest\",
      \"{{USER_NAME}}\": \"wsctltest\",
      \"{{WORKSPACE_DEPLOYMENT_NAME}}\": \"ws-dep\",
      \"{{WORKSPACE_INGRESS_NAME}}\": \"ws-ing\",
      \"{{WORKSPACE_SERVICE_MAIN_PORT_NAME}}\": \"mainPort\",
      \"{{WORKSPACE_SERVICE_NAME}}\": \"ws-svc\",
      \"{{WORKSPACE}}\": \"ws-test\"
    },
    \"override\": {
      \"scale\": [
        {
          \"target\": {
            \"kind\": \"Deployment\",
            \"name\": \"ws-dep\",
            \"apiVersion\": \"apps/v1\"
          },
          \"replicas\": 0
        }
      ],
      \"network\": {
        \"ingress\": [
          {
            \"targetName\": \"ws-ing\",
            \"rules\": [
              {
                \"http\": {
                  \"paths\": [
                    {
                      \"path\": \"/path\",
                      \"pathType\": \"Prefix\",
                      \"backend\": {
                        \"service\": {
                          \"name\": \"ws-test-ws-svc\",
                          \"port\": {
                            \"name\": \"port3000\"
                          }
                        }
                      }
                    }
                  ]
                }
              }
            ]
          }
        ],
        \"service\": [
          {
            \"targetName\": \"ws-svc\",
            \"ports\": [
              {
                \"name\": \"port3000\",
                \"protocol\": \"TCP\",
                \"port\": 30000,
                \"targetPort\": 30000
              }
            ]
          }
        ]
      },
      \"patchesJson6902\": [
        {
          \"target\": {
            \"kind\": \"IngressRoute\",
            \"name\": \"ws-ing\",
            \"apiVersion\": \"traefik.io/v1alpha1\"
          },
          \"patch\": \"[{\\n\\\"op\\\": \\\"replace\\\",\\n\\\"path\\\": \\\"/spec/routes\\\",\\n\\\"value\\\": [{\\\"match\\\":\\\"PathPrefix(`/path`)\\\",\\\"kind\\\":\\\"Rule\\\",\\\"priority\\\":100,\\\"services\\\":[{\\\"name\\\":\\\"ws-test-ws-svc\\\",\\\"kind\\\":\\\"Service\\\",\\\"port\\\":\\\"port3000\\\",\\\"scheme\\\":\\\"http\\\"}],\\\"middlewares\\\":[{\\\"name\\\":\\\"ws-test-headers\\\"},{\\\"name\\\":\\\"cosmo-auth\\\",\\\"namespace\\\":\\\"cosmo-system\\\"}]}]\\n}]\"
        }
      ]
    }
  },
  \"status\": {
    \"templateName\": \"code-server-test\",
    \"lastApplied\": [
      {
        \"kind\": \"Deployment\",
        \"namespace\": \"cosmo-user-wsctltest\",
        \"name\": \"ws-test-ws-dep\",
        \"apiVersion\": \"apps/v1\"
      },
      {
        \"kind\": \"Ingress\",
        \"namespace\": \"cosmo-user-wsctltest\",
        \"name\": \"ws-test-ws-ing\",
        \"apiVersion\": \"networking.k8s.io/v1\"
      },
      {
        \"kind\": \"Service\",
        \"namespace\": \"cosmo-user-wsctltest\",
        \"name\": \"ws-test-ws-svc\",
        \"apiVersion\": \"v1\"
      }
    ],
    \"lastAppliedObjectsCount\": 3,
    \"templateObjectsCount\": 3
  }
}
"""

['Workspace controller when updating Workspace spec should do reconcile again and update child Instance 2']
SnapShot = """
{
  \"metadata\": {
    \"name\": \"ws-test\",
    \"namespace\": \"cosmo-user-wsctltest\",
    \"creationTimestamp\": null,
    \"labels\": {
      \"cosmo-workspace.github.io/controller-managed\": \"1\"
    },
    \"ownerReferences\": [
      {
        \"apiVersion\": \"cosmo-workspace.github.io/v1alpha1\",
        \"kind\": \"Workspace\",
        \"name\": \"ws-test\",
        \"uid\": \"\",
        \"controller\": true,
        \"blockOwnerDeletion\": true
      }
    ]
  },
  \"spec\": {
    \"routes\": [
      {
        \"match\": \"PathPrefix(`/path`)\",
        \"kind\": \"Rule\",
        \"priority\": 100,
        \"services\": [
          {
            \"name\": \"ws-test-ws-svc\",
            \"kind\": \"Service\",
            \"port\": 3000,
            \"scheme\": \"http\"
          }
        ],
        \"middlewares\": [
          {
            \"name\": \"userNameHeader\"
          },
          {
            \"name\": \"cosmo-auth\",
            \"namespace\": \"cosmo-system\"
          }
        ]
      }
    ],
    \"entryPoints\": [
      \"web\",
      \"websecure\"
    ]
  }
}
"""
